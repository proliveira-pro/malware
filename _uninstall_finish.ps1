#
# _uninstall.ps1 
# 
# Proposito: Executar a desinstalacao de programa especifico em um host
# Escrito por: Ped4ro R Oliveira
# 

# Definir filtro da aplicacao a desinstalada
$_apps = "zoom"

# Busca por resultados de aplicativos instalados em 3 etapas diferentes
$_installed = Get-ItemProperty HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, UninstallString
$_installed += Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, UninstallString
$_installed += Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object  DisplayName, UninstallString
Write-Output "installed",$_installed



# Filtra o app nos resultados
$_result = $_installed | ?{ $_.DisplayName -ne $null } | sort-object -Property DisplayName -Unique | Where-object { $_.DisplayName -match "^*zoom*"} | select-object UninstallString
Write-Output "Result",$_result

$_uninstall_command = $_result.quietuninstallString
Write-Output "command",$_uninstall_command


$user_account = Get-WmiObject Win32_computerSystem | Select-Object -ExpandProperty username | Split-Path -Leaf

exit(0)

# Executa o processo de desinstalacao
#if ($_result.Uninstallstring -like "msiexec*") {
#    $_args = (($_result.UninstallString -split ' ')[1] -replace '/I','/X ') + ' /q'
#    Start-Process msiexec.exe -ArgumentList $_args -Wait
#    } 
#else {
#    Start-Process $_result.uninstallString -Wait
#}
#echo "Resultado para $_search"
#$_result.DisplayName

